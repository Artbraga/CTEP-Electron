<div class="custom-select">
    <label *ngIf="label != null">{{label}}</label>
    <mat-form-field appearance="outline">
        <mat-select #selectControl [(value)]="selected" [multiple]="multiple"
        [disabled]="disabled" (selectionChange)="onChange($event.value)"
        [compareWith]="compareWith"
           (openedChange)="openChanged($event)" [ngStyle]="style" [placeholder]="placeholder" >

            <ng-container *ngIf="getLoading(); else loading">

                <mat-option *ngFor="let op of options" [value]="op">
                    {{op[field]}}
                </mat-option>

            </ng-container>
            <ng-template #loading>
                <mat-option disabled>
                    <div style="display:flex">
                        <span>Loading...</span>
                        <span>
                            <mat-progress-spinner color="primary" mode="indeterminate" diameter="15">
                            </mat-progress-spinner>
                        </span>
                    </div>
                </mat-option>
            </ng-template>

        </mat-select>
    </mat-form-field>
</div>